{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, ChangeDetectionStrategy, inject, ViewChild } from '@angular/core';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nlet CreateUpdateMemberComponent = class CreateUpdateMemberComponent {\n  constructor(router, activatedRoute, change, familyMemberService, imageCompress, ngZone) {\n    this.router = router;\n    this.activatedRoute = activatedRoute;\n    this.change = change;\n    this.familyMemberService = familyMemberService;\n    this.imageCompress = imageCompress;\n    this.ngZone = ngZone;\n    this._snackBar = inject(MatSnackBar);\n    this.horizontalPosition = 'center';\n    this.verticalPosition = 'top';\n    this.selectedFile = null;\n    this.previewUrl = null;\n    this.isLoading = true; // Track the loading state\n    this.isLoadingOnSubmit = false;\n    this.isFormSubmitted = false; // Track if the form has been submitted\n    this.familyMember = {\n      familyHead: false,\n      firstName: '',\n      lastName: '',\n      fatherName: '',\n      gender: '',\n      dateOfBirth: '',\n      maritalStatus: '',\n      bloodGroup: '',\n      education: '',\n      permanentAddress: '',\n      mobile: '',\n      altMobile: '',\n      whatsappMobile: '',\n      email: '',\n      area: '',\n      checkedSameAddress: false,\n      checkedSameWhatsappNumber: false,\n      currentAddress: '',\n      profession: '',\n      professionAddress: '',\n      professionEmail: '',\n      professionNumber: '',\n      checkIAffirm: false,\n      aborigine: '',\n      status: 'Pending',\n      role: '',\n      ratriBhojanTyag: '',\n      dhowanPani: '',\n      professiondd: '',\n      navkarsi: '',\n      sthanak: [],\n      interest: [],\n      availability: '',\n      monthlyHours: '',\n      sameAddAsFamilyHeadAddCheck: false,\n      garamPani: '',\n      latitude: 0,\n      longitude: 0\n    };\n    this.allSthanks = [\"Ahinsapuri Jain Sthanak Bhawan,Fatehpura\", \"Aradhana Bhawan,Moti Magri Scheme,Near Jain Mandir\", \"Devendra Dham, opp celebration Mall\", \"Lokashah Jain Sthanak,Ashok Nagar\", \"Mahaveer Bhawan Sector 11\", \"Mahaveer Bhawan Sector 5\", \"Mahaveer Bhawan Subash Nagar\", \"Mahaveer Bhawan, Sector 3\", \"Mahaveer Jain Bhawan , Ganesh Nagar\", \"Mahaveer Jain Shwetambar Samiti Sector 14\", \"Mahaveer Swadhyay Smiti,Ambamata\", \"Mahaveer bhawan Sunderwas\", \"Mohan Gyan Mandir & Juwar Bhawan, Bhopalpura\", \"Nakoda Nagar Jain Sthanak, Nakoda Nagar\", \"Ostwal Bhawan,Panchayati Noyra,Porwal Ka Noyra,mukherjee chowk\", \"Rishabh Bhawan, Ayad\", \"Shree Vardhman Sthanakwasi Jain Shravak Sansthan, Sector 4\", \"Shri Jain Dharm Sthanak,Sector 14\"];\n    this.areas = [\"Amba Mata\", \"Alkapuri\", \"Amba Mata Scheme\", \"Harsh Nagar\", \"Mulla Talai\", \"Mulla Talai Choraha\", \"Rampura Choraha\", \"Rampura Road\", \"Sisarma Road\", \"Ashok Nagar\", \"Durga Nursery Road\", \"Ayad\", \"Adarsh Nagar\", \"Ashirwad Nagar\", \"Ashok Vihar\", \"Friends Colony\", \"Heera bagh Colony\", \"Jain Colony\", \"Keshav Nagar\", \"Khanij Nagar\", \"New Ashok Vihar\", \"New Bhupalpura\", \"New Keshav Nagar\", \"New RTO\", \"University Road\", \"Bhopalpura\", \"Bhatt ji ki Bari\", \"Gumaniawala nala\", \"hospital road\", \"madhuvan\", \"New Ashok Nagar\", \"New Bhopalpura\", \"New Navratan\", \"Residency Road\", \"Sardarpura\", \"Bhuwana\", \"Shobhagpura\", \"Meera Nagar\", \"Fatehpura\", \"Badgaon\", \"Bedla\", \"Bedla Road\", \"Dewali\", \"New Fatehpura\", \"Old Fatehpura\", \"Pulla\", \"R K Circle\", \"Sukhadia Circle\", \"Syphon\", \"Moti Magri Scheme\", \"Daitya Magri\", \"Panchwati\", \"Saheli Nagar\", \"Polo Ground\", \"New Polo Ground\", \"Ganesh Nagar\", \"Bohra Ganesh\", \"Bohra Ganesh ji Main Road\", \"Dhulkot Choraha\", \"Ganesh Nagar\", \"Pahada\", \"University Campus\", \"Goverdhan vilas\", \"Sector 14\", \"Mewar Motors Gali\", \"Gulab Bagh Road\", \"Mehtaji ki badi\", \"Mogra wadi\", \"Shivaji Nagar\", \"Sarvaritu Vilas\", \"Amal Ka Kanta\", \"Ashwini Bazar\", \"Bada Bazar\", \"Bapu Bazar\", \"Bhadbhuja Ghati\", \"Bhadesar Chowk\", \"Bhoiwada\", \"Bhopalwadi\", \"Delhigate\", \"Dhanmandi\", \"Ghanta Ghar\", \"Hathipole\", \"Jagdish Chowk\", \"Kheradi Wada\", \"Lakhara Chowk\", \"Mandi Ki Naal\", \"Moti Chowk\", \"Mukherjee Chowk\", \"Sindhi Bazar\", \"Maldas Street\", \"Madri Industrial Area\", \"Madri Road\", \"Pratap Nagar\", \"North Sunderwas\", \"Ostwal Nagar\", \"South Sunderwas\", \"Purohito Ki Madri\", \"Nakoda Nagar\", \"Dhuauji ki Badi\", \"N B Nagar\", \"RK Puram\", \"Bhuwana\", \"Navratan Complex\", \"New Navratan\", \"Sukher\", \"Sector 3\", \"Kesar Bagh\", \"MDS School\", \"Dore Nagar\", \"Vrindavan Vihar\", \"Vivek Nagar\", \"Tilak Nagar\", \"Shanti Nagar & New Shanti Nagar\", \"Samta Nagar\", \"Vivek Park & Eklingnath Colony\", \"Nirmal Vihar\", \"Rishi Nagar & Samta Nagar\", \"Parshwanath Nagar\", \"Sector 4\", \"Vidhya Nagar\", \"Vaishali Apartment\", \"Tagore Nagar\", \"Seva Nagar & Petro Pump Road\", \"Sarvottam Complex\", \"New Vidhya Nagar\", \"New Shiv Nagar\", \"Nakoda Complex\", \"Mayur Complex\", \"Mahaveeram Apartment\", \"Mahaveer Nagar\", \"Gyan Nagar & Pooja Nagar\", \"Chanakyapuri\", \"Adarsh nagar\", \"Sector 5\", \"Eklingpura\", \"Manwa Kheda\", \"Paneriyon Ki Madri\", \"Gariawas\", \"Mali Colony\", \"Tekri\", \"Tekri Road\", \"Kashipuri\", \"Savina\", \"Sector 6\", \"Sector 7\", \"Sector 8\", \"Sector 9\", \"Machla Magra\", \"Sector 11\", \"Sector 13\", \"Sector 14\", \"Balicha\", \"Subash nagar\", \"opp M B College\", \"Patho Ki Magri\", \"Sevashram Choraha\"];\n    this.familyId = 0;\n    this.pageMode = '';\n    this.fileSizeError = false; // To show/hide file size error\n    this.maxFileSize = 100 * 1024; // 100 KB in bytes\n    this.loggedInRole = '';\n    this.loggedInMemberId = 0;\n    this.mapCenter = {\n      lat: 24.5854,\n      lng: 73.7125\n    }; // default to Udaipur\n    this.markerPosition = {\n      lat: 24.5854,\n      lng: 73.7125\n    };\n  }\n  ngOnInit() {\n    this.isLoading = true; // Show progress bar\n    this.memeberId = this.activatedRoute.snapshot.paramMap.get('id');\n    this.pageMode = this.activatedRoute.snapshot.paramMap.get('pageMode');\n    this.loggedInRole = this.familyMemberService.getLoggedInRole();\n    this.loggedInMemberId = this.familyMemberService.getLoggedInMemberId();\n    //this.alreadyExistingFamilyHead = false;\n    this.alreadyExistingPhoneNumberForAnotherFamily = false;\n    this.familyMemberService.getFamilyByMemberId(this.memeberId).subscribe({\n      next: data => {\n        this.currentFamily = data;\n        this.familyId = data.familyId;\n        //console.log(this.currentFamily);\n        this.alreadyExistingFamilyHead = this.checkForAlreadyExistingFamilyHead(data);\n      },\n      error: e => {\n        console.error(e);\n        this.alreadyExistingFamilyHead = false;\n        this.isLoading = false; // Hide progress bar on error\n      }\n    });\n\n    if (this.pageMode === 'edit') {\n      this.isLoading = true; // Show progress bar\n      this.familyMemberService.getMemberById(this.memeberId).subscribe({\n        next: data => {\n          this.familyMember = data;\n          if (this.familyMember.checkedSameWhatsappNumber === null) {\n            this.familyMember.checkedSameWhatsappNumber = false;\n          }\n          this.isLoading = false;\n          // if(this.familyMember.photo !== null) {\n          //   this.selectedFile = this.familyMember.photo;\n          // }\n          //console.log(data);\n        },\n\n        error: e => {\n          console.error(e);\n          this.isLoading = false; // Hide progress bar on error\n        }\n      });\n    }\n\n    this.familyMemberService.getAllFamiliesForDefaultSearch().subscribe({\n      next: data => {\n        this.allFamilyMembers = data;\n        this.isLoading = false;\n      },\n      error: e => {\n        console.error(e);\n        this.isLoading = false; // Hide progress bar on error\n      }\n    });\n  }\n\n  onSaveOrUpdate() {\n    this.isFormSubmitted = true; // Mark that the form has been submitted\n    if (!this.memberForm || this.memberForm.invalid) {\n      console.log(\"❌ Form is invalid, cannot submit.\");\n      return; // Prevent submission if form is invalid\n    }\n\n    console.log(\"✅ Form is valid, proceeding with submission.\");\n    // Proceed with saving/updating logic...\n    if (this.isLoadingOnSubmit) return; // Prevent duplicate submissions\n    if (this.familyMember.sameAddAsFamilyHeadAddCheck || this.familyMember.checkedSameAddress || !this.familyMember.checkedSameAddress && this.familyMember.currentAddress) {\n      if (this.familyMember.checkedSameWhatsappNumber || !this.familyMember.checkedSameWhatsappNumber && this.familyMember.whatsappMobile) {\n        if (this.familyMember.firstName && this.familyMember.lastName && this.familyMember.fatherName && this.familyMember.gender && this.familyMember.dhowanPani && this.familyMember.ratriBhojanTyag && !this.checkMobileNumberErrors(this.familyMember.mobile)) {\n          this.isLoadingOnSubmit = true; // Start the spinner\n          if (this.imageInBase64) {\n            this.familyMember.photo = this.imageInBase64;\n          }\n          // Update mode logic\n          if (this.pageMode === 'edit' && this.familyMember.photo) {\n            this.familyMemberService.update(this.familyMember, this.familyId).subscribe({\n              next: res => {\n                setTimeout(() => {\n                  this.isLoadingOnSubmit = false; // Stop the spinner after delay\n                  this.submitted = true;\n                  this.openSnackBarWithDuration('Success: Member updated successfully.', 'Close');\n                  this.backToSearchPage(res.memberId);\n                }, 1000); // Simulate 1 second delay\n              },\n\n              error: e => {\n                setTimeout(() => {\n                  this.isLoadingOnSubmit = false; // Stop spinner after error delay\n                  console.error(e);\n                  this.openSnackBar('Error: Failed to update member.', 'Close');\n                }, 1000); // Simulate 1 second delay\n              }\n            });\n          } else if (this.pageMode === 'edit' && !this.familyMember.photo) {\n            this.isLoadingOnSubmit = false; // Stop the spinner\n            this.openSnackBar('Error: Please upload photo.', 'Close');\n          }\n          // Create mode logic\n          if (this.pageMode === 'create' && this.selectedFile) {\n            this.familyMember.role = 'selfedit';\n            this.familyMemberService.create(this.familyMember, this.familyId).subscribe({\n              next: res => {\n                setTimeout(() => {\n                  this.isLoadingOnSubmit = false; // Stop the spinner after delay\n                  this.submitted = true;\n                  this.openSnackBarWithDuration('Success: Member added successfully.', 'Close');\n                  this.backToSearchPage(res.memberId);\n                }, 1000); // Simulate 1 second delay\n              },\n\n              error: e => {\n                setTimeout(() => {\n                  this.isLoadingOnSubmit = false; // Stop spinner after error delay\n                  console.error(e);\n                  this.openSnackBar('Error: Failed to add member.', 'Close');\n                }, 1000); // Simulate 1 second delay\n              }\n            });\n          } else if (this.pageMode === 'create' && !this.selectedFile) {\n            this.isLoadingOnSubmit = false; // Stop the spinner\n            this.openSnackBar('Error: Please upload photo of size less than 1 MB.', 'Close');\n          }\n        } else {\n          this.openSnackBar('Error: Mobile number entered belongs to already existing family.', 'Close');\n        }\n      } else {\n        this.openSnackBar('Error: WhatsApp number is required if not same as Primary mobile number.', 'Close');\n      }\n    } else {\n      this.openSnackBar('Error: Current address is required if not same as Permanent address.', 'Close');\n    }\n  }\n  backToSearchPage(memberId) {\n    if (memberId !== undefined && memberId !== null && memberId !== '' && memberId !== 0 && memberId !== \"0\") {\n      this.router.navigate(['/dashboard', {\n        id: memberId,\n        afterSaveOrUpdate: true\n      }]);\n    } else {\n      this.router.navigate(['/dashboard', {\n        afterSaveOrUpdate: false\n      }]);\n    }\n  }\n  // onFileSelected(event: any): void {\n  //   const fileInput = event.target as HTMLInputElement;\n  //   if (fileInput.files && fileInput.files[0]) {\n  //     this.selectedFile = fileInput.files[0];\n  //     // Check file size\n  //     if (this.selectedFile.size > this.maxFileSize) {\n  //       this.fileSizeError = true; // Show error message\n  //       this.previewUrl = null;    // Clear preview URL\n  //       return; // Stop further execution\n  //     } else {\n  //       this.fileSizeError = false; // Hide error message\n  //     }\n  //     const reader = new FileReader();\n  //     reader.onload = (e) => {\n  //       const result = reader.result as string;\n  //       // Set the image preview URL\n  //       this.previewUrl = result;\n  //       // Extract the Base64 string and store it in the familyMember.photo\n  //       const base64String = result.split(',')[1];\n  //       this.familyMember.photo = base64String;\n  //     };\n  //     reader.readAsDataURL(this.selectedFile);\n  //   }\n  // }\n  onFileSelected(event) {\n    const fileInput = event.target;\n    if (fileInput.files && fileInput.files[0]) {\n      this.selectedFile = fileInput.files[0];\n      if (this.selectedFile.size > this.maxFileSize) {\n        this.compressImage(this.selectedFile);\n      } else {\n        this.convertToBase64(this.selectedFile);\n      }\n    }\n  }\n  // ✅ Ensure preview is updated after compression\n  compressImage(file) {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => {\n      const imageBase64 = reader.result;\n      let quality = 80;\n      let width = 50;\n      let height = 50;\n      let lastSizeInKB = 0;\n      const startTime = performance.now(); // Start compression timer\n      const compressUntilSize = (imageDataUrl, quality, width, height) => {\n        this.imageCompress.compressFile(imageDataUrl, -1, quality, width).then(compressedImage => {\n          let compressedSize = this.imageCompress.byteCount(compressedImage);\n          let compressedSizeInKB = (compressedSize / 1024).toFixed(2);\n          lastSizeInKB = parseFloat(compressedSizeInKB);\n          console.log(`📉 Compressed Image Size: ${compressedSizeInKB} KB (Quality: ${quality}, Width: ${width}, Height: ${height})`);\n          if (compressedSize <= this.maxFileSize) {\n            const endTime = performance.now(); // End compression timer\n            console.log(`✔️ Final Compressed Size: ${compressedSizeInKB} KB`);\n            console.log(`⏳ Compression Time: ${(endTime - startTime).toFixed(2)} ms`);\n            // ✅ Force Angular UI update\n            this.ngZone.run(() => {\n              this.imageInBase64 = compressedImage.split(',')[1];\n              this.previewUrl = compressedImage; // ✅ Ensures new reference for UI update\n              this.change.detectChanges(); // 🔥 Refresh UI\n            });\n\n            return;\n          } else if (quality > 10) {\n            quality -= 10;\n            width -= 10;\n            height -= 10;\n            console.log(`⚠️ Retrying with Quality ${quality}, Width ${width}, Height ${height}...`);\n            compressUntilSize(imageDataUrl, quality, width, height);\n          } else {\n            console.warn(\"❌ Cannot compress further without major quality loss.\");\n            console.log(`🚨 Last Converted Size: ${lastSizeInKB} KB`);\n            // Ensure UI updates when compression fails\n            this.ngZone.run(() => {\n              this.fileSizeError = true;\n              this.change.detectChanges();\n            });\n          }\n        });\n      };\n      compressUntilSize(imageBase64, quality, width, height);\n    };\n  }\n  convertToBase64(file) {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => {\n      this.imageInBase64 = reader.result.split(',')[1]; // Store Base64\n      this.previewUrl = reader.result; // Show image preview\n    };\n  }\n\n  setFormData() {\n    this.formdata = new FormData();\n    this.formdata.append('familyMember', new Blob([JSON.stringify(this.familyMember)], {\n      type: 'application/json'\n    }));\n  }\n  goBack(id) {\n    this.router.navigate(['/family', id]);\n  }\n  checkForAlreadyExistingFamilyHead(data) {\n    const familyMembers = data.members;\n    for (var i = 0; i < familyMembers.length; i++) {\n      if (familyMembers[i].familyHead) {\n        return true;\n      }\n    }\n    return false;\n  }\n  checkMobileNumberErrors(mobile) {\n    //const inputMobileNumber = event.target.value;\n    this.alreadyExistingPhoneNumberForAnotherFamily = this.checkForAlreadyExistingPhoneNumberForAnotherFamily(mobile);\n    //this.change.detectChanges();\n    return this.alreadyExistingPhoneNumberForAnotherFamily;\n  }\n  checkForAlreadyExistingPhoneNumberForAnotherFamily(inputMobileNumber) {\n    const allmembers = this.allFamilyMembers;\n    var currentFamilyMembers;\n    if (this.currentFamily !== null && this.currentFamily !== undefined && this.currentFamily.members !== undefined && this.currentFamily.members?.length > 0) {\n      currentFamilyMembers = this.currentFamily.members;\n    } else {\n      currentFamilyMembers = [];\n    }\n    if (allmembers !== null && allmembers !== undefined && allmembers.length > 0) {\n      var i = allmembers.length;\n      while (i--) {\n        if (currentFamilyMembers !== undefined) {\n          for (let j = 0; j < currentFamilyMembers.length; j++) {\n            if (allmembers[i].memberId === currentFamilyMembers[j].memberId) {\n              allmembers.splice(i, 1);\n              break;\n            }\n          }\n        }\n      }\n      for (let k = 0; k < allmembers.length; k++) {\n        if (allmembers[k].mobile === inputMobileNumber) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  openSnackBar(message, action) {\n    this._snackBar.open(message, action, {\n      horizontalPosition: this.horizontalPosition,\n      verticalPosition: this.verticalPosition\n    });\n  }\n  openSnackBarWithDuration(message, action) {\n    this._snackBar.open(message, action, {\n      horizontalPosition: this.horizontalPosition,\n      verticalPosition: this.verticalPosition,\n      duration: 8 * 1000\n    });\n  }\n  onSameAddressCheck(event) {\n    if (event.target.checked || this.pageMode === 'edit' && this.familyMember.checkedSameAddress) {\n      this.familyMember.currentAddress = this.familyMember.permanentAddress;\n    } else {\n      //this.familyMember.currentAddress = '';\n    }\n    console.log(event.target.value);\n  }\n  onSameAddressAsFamilyHeadCheck(event) {\n    this.familyMember.sameAddAsFamilyHeadAddCheck = event.target.checked;\n    console.log(event.target.value);\n  }\n  onSameWhatsAppNumberCheck(event) {\n    if (event.target.checked || this.pageMode === 'edit' && this.familyMember.checkedSameWhatsappNumber) {\n      this.familyMember.whatsappMobile = this.familyMember.mobile;\n    } else {\n      //this.familyMember.whatsappMobile = '';\n    }\n    console.log(event.target.value);\n  }\n  isSelfEdit(memberId) {\n    this.loadFamilyData(memberId);\n    if (this.familyMemberForAccessCheck != undefined && this.familyMemberForAccessCheck.members != undefined) {\n      for (let i = 0; i < this.familyMemberForAccessCheck?.members.length; i++) {\n        if (this.loggedInRole === 'selfedit' && this.loggedInMemberId === this.familyMemberForAccessCheck.members[i].memberId) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  loadFamilyData(id) {\n    //this.isLoading = true;  // Show progress bar\n    this.familyMemberService.getFamilyByMemberId(id).subscribe({\n      next: data => {\n        this.familyMemberForAccessCheck = data;\n        //this.isLoading = false;\n        //console.log(data);\n      },\n\n      error: e => {\n        console.error(e);\n        //this.isLoading = false;  // Hide progress bar on error\n      }\n    });\n  }\n\n  checkRoles() {\n    if (this.pageMode === 'edit') {\n      if (this.loggedInRole === 'admin' || this.loggedInRole === 'edit' || this.isSelfEdit(this.familyMember.memberId)) {\n        return true;\n      }\n    }\n    if (this.pageMode === 'create') {\n      if (this.loggedInRole === 'admin' || this.loggedInRole === 'edit') {\n        return true;\n      }\n    }\n    return false;\n  }\n  ngAfterViewInit() {\n    const input = this.searchBox.nativeElement;\n    const autocomplete = new google.maps.places.Autocomplete(input);\n    autocomplete.addListener('place_changed', () => {\n      this.ngZone.run(() => {\n        const place = autocomplete.getPlace();\n        if (place.geometry && place.geometry.location) {\n          const lat = place.geometry.location.lat();\n          const lng = place.geometry.location.lng();\n          this.mapCenter = {\n            lat,\n            lng\n          };\n          this.markerPosition = {\n            lat,\n            lng\n          };\n          this.familyMember.latitude = lat;\n          this.familyMember.longitude = lng;\n        }\n      });\n    });\n  }\n  getCurrentLocation() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        const lat = position.coords.latitude;\n        const lng = position.coords.longitude;\n        this.mapCenter = {\n          lat,\n          lng\n        };\n        this.markerPosition = {\n          lat,\n          lng\n        };\n        this.familyMember.latitude = lat;\n        this.familyMember.longitude = lng;\n      }, error => {\n        console.error(\"Geolocation error:\", error);\n        this.openSnackBar('Location access denied or unavailable.', 'Close');\n      });\n    } else {\n      this.openSnackBar('Geolocation not supported by this browser.', 'Close');\n    }\n  }\n  onMapClick(event) {\n    if (event.latLng) {\n      const lat = event.latLng.lat();\n      const lng = event.latLng.lng();\n      this.markerPosition = {\n        lat,\n        lng\n      };\n      this.familyMember.latitude = lat;\n      this.familyMember.longitude = lng;\n    }\n  }\n  onMarkerDrag() {\n    const position = this.marker.getPosition();\n    if (position) {\n      const lat = position.lat();\n      const lng = position.lng();\n      this.markerPosition = {\n        lat,\n        lng\n      };\n      this.familyMember.latitude = lat;\n      this.familyMember.longitude = lng;\n    }\n  }\n  preventSubmit(event) {\n    event.preventDefault(); // stops form submission on Enter\n  }\n};\n\n__decorate([ViewChild('memberForm')], CreateUpdateMemberComponent.prototype, \"memberForm\", void 0);\n__decorate([ViewChild('searchBox')], CreateUpdateMemberComponent.prototype, \"searchBox\", void 0);\n__decorate([ViewChild('marker')], CreateUpdateMemberComponent.prototype, \"marker\", void 0);\nCreateUpdateMemberComponent = __decorate([Component({\n  selector: 'app-create-update-member',\n  templateUrl: './create-update-member.component.html',\n  changeDetection: ChangeDetectionStrategy.Default,\n  styleUrls: ['./create-update-member.component.css']\n})], CreateUpdateMemberComponent);\nexport { CreateUpdateMemberComponent };","map":{"version":3,"names":["Component","ChangeDetectionStrategy","inject","ViewChild","MatSnackBar","CreateUpdateMemberComponent","constructor","router","activatedRoute","change","familyMemberService","imageCompress","ngZone","_snackBar","horizontalPosition","verticalPosition","selectedFile","previewUrl","isLoading","isLoadingOnSubmit","isFormSubmitted","familyMember","familyHead","firstName","lastName","fatherName","gender","dateOfBirth","maritalStatus","bloodGroup","education","permanentAddress","mobile","altMobile","whatsappMobile","email","area","checkedSameAddress","checkedSameWhatsappNumber","currentAddress","profession","professionAddress","professionEmail","professionNumber","checkIAffirm","aborigine","status","role","ratriBhojanTyag","dhowanPani","professiondd","navkarsi","sthanak","interest","availability","monthlyHours","sameAddAsFamilyHeadAddCheck","garamPani","latitude","longitude","allSthanks","areas","familyId","pageMode","fileSizeError","maxFileSize","loggedInRole","loggedInMemberId","mapCenter","lat","lng","markerPosition","ngOnInit","memeberId","snapshot","paramMap","get","getLoggedInRole","getLoggedInMemberId","alreadyExistingPhoneNumberForAnotherFamily","getFamilyByMemberId","subscribe","next","data","currentFamily","alreadyExistingFamilyHead","checkForAlreadyExistingFamilyHead","error","e","console","getMemberById","getAllFamiliesForDefaultSearch","allFamilyMembers","onSaveOrUpdate","memberForm","invalid","log","checkMobileNumberErrors","imageInBase64","photo","update","res","setTimeout","submitted","openSnackBarWithDuration","backToSearchPage","memberId","openSnackBar","create","undefined","navigate","id","afterSaveOrUpdate","onFileSelected","event","fileInput","target","files","size","compressImage","convertToBase64","file","reader","FileReader","readAsDataURL","onload","imageBase64","result","quality","width","height","lastSizeInKB","startTime","performance","now","compressUntilSize","imageDataUrl","compressFile","then","compressedImage","compressedSize","byteCount","compressedSizeInKB","toFixed","parseFloat","endTime","run","split","detectChanges","warn","setFormData","formdata","FormData","append","Blob","JSON","stringify","type","goBack","familyMembers","members","i","length","checkForAlreadyExistingPhoneNumberForAnotherFamily","inputMobileNumber","allmembers","currentFamilyMembers","j","splice","k","message","action","open","duration","onSameAddressCheck","checked","value","onSameAddressAsFamilyHeadCheck","onSameWhatsAppNumberCheck","isSelfEdit","loadFamilyData","familyMemberForAccessCheck","checkRoles","ngAfterViewInit","input","searchBox","nativeElement","autocomplete","google","maps","places","Autocomplete","addListener","place","getPlace","geometry","location","getCurrentLocation","navigator","geolocation","getCurrentPosition","position","coords","onMapClick","latLng","onMarkerDrag","marker","getPosition","preventSubmit","preventDefault","__decorate","selector","templateUrl","changeDetection","Default","styleUrls"],"sources":["/Users/sanyamlodha/Personal/Samta/code/demo-heroku/demo-heroku-ui/demo-heroku-ui/src/app/create-update-member/create-update-member.component.ts"],"sourcesContent":["import { Component, OnInit, ChangeDetectionStrategy, NgZone, ChangeDetectorRef, inject, ViewChild, ElementRef, AfterViewInit } from '@angular/core';\nimport { NgForm } from '@angular/forms';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { FamilyMember } from '../models/FamilyMember.model';\nimport { Member } from '../models/Member.model';\nimport { FamilyMemberService } from 'src/app/services/familyMember.service';\nimport {\n  MatSnackBar,\n  MatSnackBarHorizontalPosition,\n  MatSnackBarVerticalPosition,\n} from '@angular/material/snack-bar';\nimport { NgxImageCompressService } from 'ngx-image-compress';\nimport { MapInfoWindow, MapMarker } from '@angular/google-maps';\n\n\n@Component({\n  selector: 'app-create-update-member',\n  templateUrl: './create-update-member.component.html',\n  changeDetection: ChangeDetectionStrategy.Default,\n  styleUrls: ['./create-update-member.component.css']\n})\nexport class CreateUpdateMemberComponent  implements OnInit{\n  private _snackBar = inject(MatSnackBar);\n  horizontalPosition: MatSnackBarHorizontalPosition = 'center';\n  verticalPosition: MatSnackBarVerticalPosition = 'top';\n\n  selectedFile: File | null = null;\n  previewUrl: string | ArrayBuffer | null = null;\n  formdata!: FormData;\n  imageInBase64!: string; \n  isLoading = true;  // Track the loading state\n  isLoadingOnSubmit = false;\n  @ViewChild('memberForm') memberForm!: NgForm;\n  isFormSubmitted = false; // Track if the form has been submitted\n\n\n  familyMember: Member = {\n    familyHead: false,\n    firstName: '',\n    lastName:  '',\n    fatherName: '',\n    gender: '',\n    dateOfBirth: '',\n    maritalStatus: '',\n    bloodGroup: '',\n    education: '',\n    permanentAddress: '',\n    mobile: '',\n    altMobile: '',\n    whatsappMobile: '',\n    email: '',\n    area: '',\n    checkedSameAddress: false,\n    checkedSameWhatsappNumber: false,\n    currentAddress: '',\n    profession: '',\n    professionAddress: '',\n    professionEmail: '',\n    professionNumber: '',\n    checkIAffirm: false,\n    aborigine: '',\n    status: 'Pending',\n    role: '',\n    ratriBhojanTyag: '',\n    dhowanPani: '',\n    professiondd: '',\n    navkarsi: '',\n    sthanak: [],\n    interest: [],\n    availability: '',\n    monthlyHours: '',\n    sameAddAsFamilyHeadAddCheck: false,\n    garamPani: '',\n    latitude: 0,\n    longitude: 0\n  };\n\n  allSthanks: string[] = [\n    \"Ahinsapuri Jain Sthanak Bhawan,Fatehpura\",\n    \"Aradhana Bhawan,Moti Magri Scheme,Near Jain Mandir\",\n    \"Devendra Dham, opp celebration Mall\",\n    \"Lokashah Jain Sthanak,Ashok Nagar\",\n    \"Mahaveer Bhawan Sector 11\",\n    \"Mahaveer Bhawan Sector 5\",\n    \"Mahaveer Bhawan Subash Nagar\",\n    \"Mahaveer Bhawan, Sector 3\",\n    \"Mahaveer Jain Bhawan , Ganesh Nagar\",\n    \"Mahaveer Jain Shwetambar Samiti Sector 14\",\n    \"Mahaveer Swadhyay Smiti,Ambamata\",\n    \"Mahaveer bhawan Sunderwas\",\n    \"Mohan Gyan Mandir & Juwar Bhawan, Bhopalpura\",\n    \"Nakoda Nagar Jain Sthanak, Nakoda Nagar\",\n    \"Ostwal Bhawan,Panchayati Noyra,Porwal Ka Noyra,mukherjee chowk\",\n    \"Rishabh Bhawan, Ayad\",\n    \"Shree Vardhman Sthanakwasi Jain Shravak Sansthan, Sector 4\",\n    \"Shri Jain Dharm Sthanak,Sector 14\"\n  ];\n\n  areas: string[] = [\n    \"Amba Mata\", \"Alkapuri\", \"Amba Mata Scheme\", \"Harsh Nagar\", \"Mulla Talai\",\n    \"Mulla Talai Choraha\", \"Rampura Choraha\", \"Rampura Road\", \"Sisarma Road\", \"Ashok Nagar\",\n    \"Durga Nursery Road\", \"Ayad\", \"Adarsh Nagar\", \"Ashirwad Nagar\", \"Ashok Vihar\",\n    \"Friends Colony\", \"Heera bagh Colony\", \"Jain Colony\", \"Keshav Nagar\", \"Khanij Nagar\",\n    \"New Ashok Vihar\", \"New Bhupalpura\", \"New Keshav Nagar\", \"New RTO\", \"University Road\",\n    \"Bhopalpura\", \"Bhatt ji ki Bari\", \"Gumaniawala nala\", \"hospital road\", \"madhuvan\",\n    \"New Ashok Nagar\", \"New Bhopalpura\", \"New Navratan\", \"Residency Road\", \"Sardarpura\",\n    \"Bhuwana\", \"Shobhagpura\", \"Meera Nagar\", \"Fatehpura\", \"Badgaon\", \"Bedla\",\n    \"Bedla Road\", \"Dewali\", \"New Fatehpura\", \"Old Fatehpura\", \"Pulla\", \"R K Circle\",\n    \"Sukhadia Circle\", \"Syphon\", \"Moti Magri Scheme\", \"Daitya Magri\", \"Panchwati\",\n    \"Saheli Nagar\", \"Polo Ground\", \"New Polo Ground\", \"Ganesh Nagar\", \"Bohra Ganesh\",\n    \"Bohra Ganesh ji Main Road\", \"Dhulkot Choraha\", \"Ganesh Nagar\", \"Pahada\",\n    \"University Campus\", \"Goverdhan vilas\", \"Sector 14\", \"Mewar Motors Gali\",\n    \"Gulab Bagh Road\", \"Mehtaji ki badi\", \"Mogra wadi\", \"Shivaji Nagar\", \"Sarvaritu Vilas\",\n    \"Amal Ka Kanta\", \"Ashwini Bazar\", \"Bada Bazar\", \"Bapu Bazar\", \"Bhadbhuja Ghati\",\n    \"Bhadesar Chowk\", \"Bhoiwada\", \"Bhopalwadi\", \"Delhigate\", \"Dhanmandi\", \"Ghanta Ghar\",\n    \"Hathipole\", \"Jagdish Chowk\", \"Kheradi Wada\", \"Lakhara Chowk\", \"Mandi Ki Naal\",\n    \"Moti Chowk\", \"Mukherjee Chowk\", \"Sindhi Bazar\", \"Maldas Street\", \"Madri Industrial Area\",\n    \"Madri Road\", \"Pratap Nagar\", \"North Sunderwas\", \"Ostwal Nagar\", \"South Sunderwas\",\n    \"Purohito Ki Madri\", \"Nakoda Nagar\", \"Dhuauji ki Badi\", \"N B Nagar\", \"RK Puram\",\n    \"Bhuwana\", \"Navratan Complex\", \"New Navratan\", \"Sukher\", \"Sector 3\", \"Kesar Bagh\",\n    \"MDS School\", \"Dore Nagar\", \"Vrindavan Vihar\", \"Vivek Nagar\", \"Tilak Nagar\",\n    \"Shanti Nagar & New Shanti Nagar\", \"Samta Nagar\", \"Vivek Park & Eklingnath Colony\",\n    \"Nirmal Vihar\", \"Rishi Nagar & Samta Nagar\", \"Parshwanath Nagar\", \"Sector 4\",\n    \"Vidhya Nagar\", \"Vaishali Apartment\", \"Tagore Nagar\", \"Seva Nagar & Petro Pump Road\",\n    \"Sarvottam Complex\", \"New Vidhya Nagar\", \"New Shiv Nagar\", \"Nakoda Complex\",\n    \"Mayur Complex\", \"Mahaveeram Apartment\", \"Mahaveer Nagar\", \"Gyan Nagar & Pooja Nagar\",\n    \"Chanakyapuri\", \"Adarsh nagar\", \"Sector 5\", \"Eklingpura\", \"Manwa Kheda\",\n    \"Paneriyon Ki Madri\", \"Gariawas\", \"Mali Colony\", \"Tekri\", \"Tekri Road\",\n    \"Kashipuri\", \"Savina\", \"Sector 6\", \"Sector 7\", \"Sector 8\", \"Sector 9\",\n    \"Machla Magra\", \"Sector 11\", \"Sector 13\", \"Sector 14\", \"Balicha\", \"Subash nagar\",\n    \"opp M B College\", \"Patho Ki Magri\", \"Sevashram Choraha\"\n  ];\n\n  submitted!: Boolean;\n  familyId: any = 0;\n  memeberId: any;\n  pageMode: string = '';\n  alreadyExistingFamilyHead!: Boolean;\n  alreadyExistingPhoneNumberForAnotherFamily!: Boolean;\n  currentFamily!: FamilyMember;\n  allFamilyMembers: any;\n  fileSizeError: boolean = false; // To show/hide file size error\n  maxFileSize: number = 100 * 1024; // 100 KB in bytes\n  loggedInRole = '';\n  loggedInMemberId = 0;\n  familyMemberForAccessCheck?: FamilyMember;\n\n  @ViewChild('searchBox') searchBox!: ElementRef;\n  @ViewChild('marker') marker!: MapMarker;\n  mapCenter = { lat: 24.5854, lng: 73.7125 }; // default to Udaipur\n  markerPosition = { lat: 24.5854, lng: 73.7125 };\n\n  constructor(private router: Router,\n    private activatedRoute: ActivatedRoute,\n    private change: ChangeDetectorRef,\n    private familyMemberService: FamilyMemberService,\n    private imageCompress: NgxImageCompressService,\n    private ngZone: NgZone\n  ) {}\n\n  ngOnInit(): void{\n    this.isLoading = true;  // Show progress bar\n    this.memeberId = this.activatedRoute.snapshot.paramMap.get('id')!;\n    this.pageMode = this.activatedRoute.snapshot.paramMap.get('pageMode')!;\n    this.loggedInRole = this.familyMemberService.getLoggedInRole();\n    this.loggedInMemberId = this.familyMemberService.getLoggedInMemberId();\n    //this.alreadyExistingFamilyHead = false;\n    this.alreadyExistingPhoneNumberForAnotherFamily = false;\n    this.familyMemberService.getFamilyByMemberId(this.memeberId).subscribe({\n      next: (data) => {\n        this.currentFamily = data;\n        this.familyId = data.familyId;\n        //console.log(this.currentFamily);\n        this.alreadyExistingFamilyHead = this.checkForAlreadyExistingFamilyHead(data);\n      },\n      error: (e) => {\n        console.error(e);\n        this.alreadyExistingFamilyHead = false;\n        this.isLoading = false;  // Hide progress bar on error\n      }\n    });\n    if(this.pageMode === 'edit'){\n      this.isLoading = true;  // Show progress bar\n      this.familyMemberService.getMemberById(this.memeberId).subscribe({\n        next: (data) => {\n          this.familyMember = data;\n          if(this.familyMember.checkedSameWhatsappNumber === null) {\n            this.familyMember.checkedSameWhatsappNumber = false;\n          }\n          this.isLoading = false;\n          // if(this.familyMember.photo !== null) {\n          //   this.selectedFile = this.familyMember.photo;\n          // }\n          //console.log(data);\n        },\n        error: (e) => {\n          console.error(e);\n          this.isLoading = false;  // Hide progress bar on error\n        }\n      });\n    }\n\n    this.familyMemberService.getAllFamiliesForDefaultSearch().subscribe({\n      next: (data) => {\n        this.allFamilyMembers = data;\n        this.isLoading = false;\n      },\n      error: (e) => {\n        console.error(e);\n        this.isLoading = false;  // Hide progress bar on error\n      }\n    });\n\n  }\n\n  onSaveOrUpdate(): void {\n    this.isFormSubmitted = true; // Mark that the form has been submitted\n\n    if (!this.memberForm || this.memberForm.invalid) {\n      console.log(\"❌ Form is invalid, cannot submit.\");\n      return; // Prevent submission if form is invalid\n    }\n\n    console.log(\"✅ Form is valid, proceeding with submission.\");\n  \n    // Proceed with saving/updating logic...\n    if (this.isLoadingOnSubmit) return; // Prevent duplicate submissions\n  \n    if (this.familyMember.sameAddAsFamilyHeadAddCheck ||\n      (this.familyMember.checkedSameAddress ||\n      (!this.familyMember.checkedSameAddress && this.familyMember.currentAddress))\n    ) {\n      if (\n        this.familyMember.checkedSameWhatsappNumber ||\n        (!this.familyMember.checkedSameWhatsappNumber && this.familyMember.whatsappMobile)\n      ) {\n        if (\n          this.familyMember.firstName &&\n          this.familyMember.lastName &&\n          this.familyMember.fatherName &&\n          this.familyMember.gender &&\n          this.familyMember.dhowanPani &&\n          this.familyMember.ratriBhojanTyag &&\n          !this.checkMobileNumberErrors(this.familyMember.mobile)\n        ) {\n          this.isLoadingOnSubmit = true; // Start the spinner\n    \n          if (this.imageInBase64) {\n            this.familyMember.photo = this.imageInBase64;\n          }\n    \n          // Update mode logic\n          if (this.pageMode === 'edit' && this.familyMember.photo) {\n            this.familyMemberService.update(this.familyMember, this.familyId).subscribe({\n              next: (res) => {\n                setTimeout(() => {\n                  this.isLoadingOnSubmit = false; // Stop the spinner after delay\n                  this.submitted = true;\n                  this.openSnackBarWithDuration('Success: Member updated successfully.', 'Close');\n                  this.backToSearchPage(res.memberId);\n                }, 1000); // Simulate 1 second delay\n              },\n              error: (e) => {\n                setTimeout(() => {\n                  this.isLoadingOnSubmit = false; // Stop spinner after error delay\n                  console.error(e);\n                  this.openSnackBar('Error: Failed to update member.', 'Close');\n                }, 1000); // Simulate 1 second delay\n              },\n            });\n          } else if (this.pageMode === 'edit' && !this.familyMember.photo) {\n            this.isLoadingOnSubmit = false; // Stop the spinner\n            this.openSnackBar('Error: Please upload photo.', 'Close');\n          }\n    \n          // Create mode logic\n          if (this.pageMode === 'create' && this.selectedFile) {\n            this.familyMember.role = 'selfedit';\n            this.familyMemberService.create(this.familyMember, this.familyId).subscribe({\n              next: (res) => {\n                setTimeout(() => {\n                  this.isLoadingOnSubmit = false; // Stop the spinner after delay\n                  this.submitted = true;\n                  this.openSnackBarWithDuration('Success: Member added successfully.', 'Close');\n                  this.backToSearchPage(res.memberId);\n                }, 1000); // Simulate 1 second delay\n              },\n              error: (e) => {\n                setTimeout(() => {\n                  this.isLoadingOnSubmit = false; // Stop spinner after error delay\n                  console.error(e);\n                  this.openSnackBar('Error: Failed to add member.', 'Close');\n                }, 1000); // Simulate 1 second delay\n              },\n            });\n          } else if (this.pageMode === 'create' && !this.selectedFile) {\n            this.isLoadingOnSubmit = false; // Stop the spinner\n            this.openSnackBar('Error: Please upload photo of size less than 1 MB.', 'Close');\n          }\n        } else {\n          this.openSnackBar('Error: Mobile number entered belongs to already existing family.', 'Close');\n        }\n      } else {\n        this.openSnackBar(\n          'Error: WhatsApp number is required if not same as Primary mobile number.',\n          'Close'\n        );\n      }\n    } else {\n      this.openSnackBar(\n        'Error: Current address is required if not same as Permanent address.',\n        'Close'\n      );\n    }\n  }  \n\n  backToSearchPage(memberId: any){\n    if(memberId !== undefined && memberId !== null && memberId !== '' && memberId !== 0 && memberId !== \"0\"){\n      this.router.navigate(['/dashboard', {id: memberId, afterSaveOrUpdate: true}]);\n    }else {\n      this.router.navigate(['/dashboard', {afterSaveOrUpdate: false}]);\n    }\n  }\n\n  // onFileSelected(event: any): void {\n  //   const fileInput = event.target as HTMLInputElement;\n    \n  //   if (fileInput.files && fileInput.files[0]) {\n  //     this.selectedFile = fileInput.files[0];\n  \n  //     // Check file size\n  //     if (this.selectedFile.size > this.maxFileSize) {\n  //       this.fileSizeError = true; // Show error message\n  //       this.previewUrl = null;    // Clear preview URL\n  //       return; // Stop further execution\n  //     } else {\n  //       this.fileSizeError = false; // Hide error message\n  //     }\n  \n  //     const reader = new FileReader();\n  //     reader.onload = (e) => {\n  //       const result = reader.result as string;\n  \n  //       // Set the image preview URL\n  //       this.previewUrl = result;\n  \n  //       // Extract the Base64 string and store it in the familyMember.photo\n  //       const base64String = result.split(',')[1];\n  //       this.familyMember.photo = base64String;\n  //     };\n  //     reader.readAsDataURL(this.selectedFile);\n  //   }\n  // }\n\n  onFileSelected(event: any): void {\n    const fileInput = event.target as HTMLInputElement;\n  \n    if (fileInput.files && fileInput.files[0]) {\n      this.selectedFile = fileInput.files[0];\n  \n      if (this.selectedFile.size > this.maxFileSize) {\n        this.compressImage(this.selectedFile);\n      } else {\n        this.convertToBase64(this.selectedFile);\n      }\n    }\n  }\n  \n  // ✅ Ensure preview is updated after compression\n  compressImage(file: File) {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => {\n      const imageBase64 = reader.result as string;\n      let quality = 80;\n      let width = 50;\n      let height = 50;\n      let lastSizeInKB = 0;\n      const startTime = performance.now(); // Start compression timer\n  \n      const compressUntilSize = (imageDataUrl: string, quality: number, width: number, height: number) => {\n        this.imageCompress.compressFile(imageDataUrl, -1, quality, width).then((compressedImage) => {\n          let compressedSize = this.imageCompress.byteCount(compressedImage);\n          let compressedSizeInKB = (compressedSize / 1024).toFixed(2);\n          lastSizeInKB = parseFloat(compressedSizeInKB);\n  \n          console.log(`📉 Compressed Image Size: ${compressedSizeInKB} KB (Quality: ${quality}, Width: ${width}, Height: ${height})`);\n  \n          if (compressedSize <= this.maxFileSize) {\n            const endTime = performance.now(); // End compression timer\n            console.log(`✔️ Final Compressed Size: ${compressedSizeInKB} KB`);\n            console.log(`⏳ Compression Time: ${(endTime - startTime).toFixed(2)} ms`);\n  \n            // ✅ Force Angular UI update\n            this.ngZone.run(() => {\n              this.imageInBase64 = compressedImage.split(',')[1];\n              this.previewUrl = compressedImage; // ✅ Ensures new reference for UI update\n              this.change.detectChanges(); // 🔥 Refresh UI\n            });\n  \n            return;\n          } else if (quality > 10) {\n            quality -= 10;\n            width -= 10;\n            height -= 10;\n            console.log(`⚠️ Retrying with Quality ${quality}, Width ${width}, Height ${height}...`);\n            compressUntilSize(imageDataUrl, quality, width, height);\n          } else {\n            console.warn(\"❌ Cannot compress further without major quality loss.\");\n            console.log(`🚨 Last Converted Size: ${lastSizeInKB} KB`);\n  \n            // Ensure UI updates when compression fails\n            this.ngZone.run(() => {\n              this.fileSizeError = true;\n              this.change.detectChanges();\n            });\n          }\n        });\n      };\n  \n      compressUntilSize(imageBase64, quality, width, height);\n    };\n  }\n\n  convertToBase64(file: File) {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => {\n      this.imageInBase64 = (reader.result as string).split(',')[1]; // Store Base64\n      this.previewUrl = reader.result; // Show image preview\n    };\n  }\n\n  setFormData() {\n    this.formdata = new FormData();\n    this.formdata.append(\n      'familyMember',\n      new Blob([JSON.stringify(this.familyMember)], { type: 'application/json' })\n    );\n  }\n  \n  goBack(id: string): void {\n    this.router.navigate(['/family', id]);\n  }\n\n  checkForAlreadyExistingFamilyHead(data: any): boolean{\n    const familyMembers = data.members;\n    for(var i=0; i < familyMembers.length; i++){\n      if(familyMembers[i].familyHead){\n        return true;\n      }\n    }\n    return false;\n  }\n\n  checkMobileNumberErrors(mobile: any){\n    //const inputMobileNumber = event.target.value;\n    this.alreadyExistingPhoneNumberForAnotherFamily = this.checkForAlreadyExistingPhoneNumberForAnotherFamily(mobile);\n    //this.change.detectChanges();\n    return this.alreadyExistingPhoneNumberForAnotherFamily;\n  }\n\n  checkForAlreadyExistingPhoneNumberForAnotherFamily(inputMobileNumber: any): Boolean {\n    const allmembers = this.allFamilyMembers;\n    var currentFamilyMembers: any[];\n    if(this.currentFamily !== null && this.currentFamily !== undefined && this.currentFamily.members !== undefined && this.currentFamily.members?.length> 0){\n      currentFamilyMembers = this.currentFamily.members;\n    }else {\n      currentFamilyMembers = [];\n    }\n\n    if(allmembers !== null && allmembers !== undefined && allmembers.length > 0){\n      var i = allmembers.length\n      while (i--) {\n        if(currentFamilyMembers !== undefined){\n          for(let j=0; j<currentFamilyMembers.length; j++)\n            {\n              if (allmembers[i].memberId === currentFamilyMembers[j].memberId) { \n                  allmembers.splice(i, 1);\n                  break;\n              }\n            }\n        }\n      }\n\n      for(let k=0; k<allmembers.length; k++){\n          if (allmembers[k].mobile === inputMobileNumber) { \n              return true;\n          }\n      }\n    }\n\n    return false;\n  }\n\n  openSnackBar(message: string, action: string) {\n    this._snackBar.open(message, action, {\n      horizontalPosition: this.horizontalPosition,\n      verticalPosition: this.verticalPosition\n    });\n  }\n\n  openSnackBarWithDuration(message: string, action: string) {\n    this._snackBar.open(message, action, {\n      horizontalPosition: this.horizontalPosition,\n      verticalPosition: this.verticalPosition,\n      duration: 8 * 1000\n    });\n  }\n\n  onSameAddressCheck(event: any){\n    if(event.target.checked || (this.pageMode === 'edit' && this.familyMember.checkedSameAddress)){\n      this.familyMember.currentAddress = this.familyMember.permanentAddress;\n    }else {\n      //this.familyMember.currentAddress = '';\n    }\n    console.log(event.target.value);\n  }\n\n  onSameAddressAsFamilyHeadCheck(event: any){\n    this.familyMember.sameAddAsFamilyHeadAddCheck = event.target.checked;\n    console.log(event.target.value);\n  }\n\n  onSameWhatsAppNumberCheck(event: any){\n    if(event.target.checked || (this.pageMode === 'edit' && this.familyMember.checkedSameWhatsappNumber)){\n      this.familyMember.whatsappMobile = this.familyMember.mobile;\n    }else {\n      //this.familyMember.whatsappMobile = '';\n    }\n    console.log(event.target.value);\n  }\n\n  isSelfEdit(memberId: any): any {\n    this.loadFamilyData(memberId);\n    if(this.familyMemberForAccessCheck != undefined && this.familyMemberForAccessCheck.members != undefined){\n      for(let i=0; i < this.familyMemberForAccessCheck?.members.length; i++){\n        if(this.loggedInRole === 'selfedit' && this.loggedInMemberId === this.familyMemberForAccessCheck.members[i].memberId){\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  loadFamilyData(id: string): void {\n    //this.isLoading = true;  // Show progress bar\n    this.familyMemberService.getFamilyByMemberId(id).subscribe({\n      next: (data) => {\n        this.familyMemberForAccessCheck = data;\n        //this.isLoading = false;\n        //console.log(data);\n      },\n      error: (e) => {\n        console.error(e);\n        //this.isLoading = false;  // Hide progress bar on error\n      }\n    });\n  }\n\n  checkRoles(): any {\n    if(this.pageMode === 'edit'){\n      if((this.loggedInRole === 'admin' ||  this.loggedInRole === 'edit') || this.isSelfEdit(this.familyMember.memberId)){\n        return true;\n      }\n    }\n\n    if(this.pageMode === 'create'){\n      if(this.loggedInRole === 'admin' ||  this.loggedInRole === 'edit'){\n        return true;\n      }\n    }\n    return false;\n  }\n\n  ngAfterViewInit() {\n    const input = this.searchBox.nativeElement;\n    const autocomplete = new google.maps.places.Autocomplete(input);\n\n    autocomplete.addListener('place_changed', () => {\n      this.ngZone.run(() => {\n        const place = autocomplete.getPlace();\n        if (place.geometry && place.geometry.location) {\n          const lat = place.geometry.location.lat();\n          const lng = place.geometry.location.lng();\n\n          this.mapCenter = { lat, lng };\n          this.markerPosition = { lat, lng };\n          this.familyMember.latitude = lat;\n          this.familyMember.longitude = lng;\n        }\n      });\n    });\n  }\n\n  getCurrentLocation() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition((position) => {\n        const lat = position.coords.latitude;\n        const lng = position.coords.longitude;\n        this.mapCenter = { lat, lng };\n        this.markerPosition = { lat, lng };\n        this.familyMember.latitude = lat;\n        this.familyMember.longitude = lng;\n      }, (error) => {\n        console.error(\"Geolocation error:\", error);\n        this.openSnackBar('Location access denied or unavailable.', 'Close');\n      });\n    } else {\n      this.openSnackBar('Geolocation not supported by this browser.', 'Close');\n    }\n  }\n\n  onMapClick(event: google.maps.MapMouseEvent) {\n    if (event.latLng) {\n      const lat = event.latLng.lat();\n      const lng = event.latLng.lng();\n      this.markerPosition = { lat, lng };\n      this.familyMember.latitude = lat;\n      this.familyMember.longitude = lng;\n    }\n  }\n\n  onMarkerDrag() {\n    const position = this.marker.getPosition();\n    if (position) {\n      const lat = position.lat();\n      const lng = position.lng();\n      this.markerPosition = { lat, lng };\n      this.familyMember.latitude = lat;\n      this.familyMember.longitude = lng;\n    }\n  }\n\n  preventSubmit(event: KeyboardEvent) {\n    event.preventDefault(); // stops form submission on Enter\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}